<<<<<<< HEAD:node_modules/.cache/esm/d49c36446bedaf88.js
let express,User,jwt;_6be‍.x([["default",()=>_6be‍.o]]);_6be‍.w("express",[["default",["express"],function(v){express=v}]]);_6be‍.w("../models/user.js",[["default",["User"],function(v){User=v}]]);_6be‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);
=======
<<<<<<<< HEAD:node_modules/.cache/esm/d49c36443a850aca.js
let express,User,jwt;_3a8‍.x([["default",()=>_3a8‍.o]]);_3a8‍.w("express",[["default",["express"],function(v){express=v}]]);_3a8‍.w("../models/user.js",[["default",["User"],function(v){User=v}]]);_3a8‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);

========
let express,User,jwt;_1c3‍.x([["default",()=>_1c3‍.o]]);_1c3‍.w("express",[["default",["express"],function(v){express=v}]]);_1c3‍.w("../models/user.js",[["default",["User"],function(v){User=v}]]);_1c3‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);
>>>>>>>> 090644277357b403d7ea67b4a3e150cd9f89cc09:node_modules/.cache/esm/d49c36441c34f9c6.js
>>>>>>> 9e8cd3fb77fa7658e507746243c061bb18802926:node_modules/.cache/esm/d49c36441c34f9c6.js



const router = express.Router();

router.get("/profile/:username", (req, res) => {
    res.render("Usuarios/profile");
});

router.get("/register", (req, res) => {
    res.render("Usuarios/register",{
        style : 'styleregister.css'
    });
});

router.post("/register" , (req, res) => {
<<<<<<< HEAD:node_modules/.cache/esm/d49c36446bedaf88.js
    _6be‍.g.console.log("data", req.body);
    User.create(req.body);
=======
<<<<<<<< HEAD:node_modules/.cache/esm/d49c36443a850aca.js
    _3a8‍.g.console.log("data", req.body);
========
    _1c3‍.g.console.log("data", req.body);
>>>>>>>> 090644277357b403d7ea67b4a3e150cd9f89cc09:node_modules/.cache/esm/d49c36441c34f9c6.js
>>>>>>> 9e8cd3fb77fa7658e507746243c061bb18802926:node_modules/.cache/esm/d49c36441c34f9c6.js

    res.render("Usuarios/register",{
        style : 'styleregister.css'
    });
});

router.get("/login", (req, res) => {
    res.render("Usuarios/login",{
        style: 'styleLogin.css'
    });
});

router.post("/login", async (req, res) => {
  const currentUser = await User.findOne({ Rut: req.body.Rut });
  if(!currentUser || currentUser.password !== req.body.password){
    res.redirect("/login");
    return;
  }
  const payload = currentUser["_doc"]
  delete payload.password;

  const signedJWT = jwt.sign(payload, "miFirma", {expiresIn: "1h"});
  tokensValidos.push(signedJWT);

  res.cookie("jwt", signedJWT).redirect("/crearvotacion");
});

<<<<<<< HEAD:node_modules/.cache/esm/d49c36446bedaf88.js
_6be‍.d(router);
=======


<<<<<<<< HEAD:node_modules/.cache/esm/d49c36443a850aca.js
_3a8‍.d(router);
========
_1c3‍.d(router);
>>>>>>>> 090644277357b403d7ea67b4a3e150cd9f89cc09:node_modules/.cache/esm/d49c36441c34f9c6.js
>>>>>>> 9e8cd3fb77fa7658e507746243c061bb18802926:node_modules/.cache/esm/d49c36441c34f9c6.js
